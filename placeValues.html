<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Place Value Practice</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <h1>🔢 Place Value Practice</h1>
  
  <label for="level">Choose Level:</label>
  <select id="level" onchange="setLevel()">
    <option value="1">Level 1 (Ones & Tens)</option>
    <option value="2">Level 2 (Hundreds)</option>
    <option value="3">Level 3 (Thousands & Tenths)</option>
    <option value="4">Level 4 (Ten-thousands & Hundredths)</option>
  </select>

  <div id="quizActive">
    <div id="question">Click "Next Question" to start</div>
    
    <input type="text" id="answer" placeholder="Your answer" disabled>
    <button onclick="checkAnswer()" disabled id="checkBtn">Check</button>
    <button onclick="nextQuestion()">Next Question</button>
  </div>

  <div id="feedback"></div>
  <div class="score" id="score"></div>
  <div class="final" id="finalScore"></div>

  <button class="back-btn" onclick="location.href='index.html'">⬅ Back to Topics</button>
  
  <script>
    let numberString, digits, correctAnswers;
    let questionCount = 0, correctCount = 0, totalQuestions = 5;
    let level = 0;
    let currentDigitIndex = 0; // which digit we are asking about

    function setLevel() {
      level = parseInt(document.getElementById('level').value);
      resetQuiz();
      nextQuestion();
    }

    function generateNumber() {
      switch (level) {
        case 1: return Math.floor(Math.random() * 90 + 10); // 2-digit
        case 2: return Math.floor(Math.random() * 900 + 100); // 3-digit
        case 3: 
          let intPart = Math.floor(Math.random() * 9000 + 1000); // 4-digit
          let decimalPart = (Math.floor(Math.random() * 9) / 10).toFixed(1); // tenths
          return intPart + decimalPart.slice(1);
        case 4:
          let intPart4 = Math.floor(Math.random() * 90000 + 10000); // 5-digit
          let decimalPart4 = (Math.floor(Math.random() * 90) / 100).toFixed(2); // hundredths
          return intPart4 + decimalPart4.slice(1);
      }
    }

    function placeValue(digit, position) {
      const powers = ["ones", "tens", "hundreds", "thousands", "ten-thousands"];
      if (position >= 0) {
        return digit * Math.pow(10, position);
      } else {
        return digit * Math.pow(10, position); // for decimals
      }
    }

    function nextQuestion() {
      if (currentDigitIndex === 0) {
        numberString = generateNumber().toString();
        digits = numberString.replace(".", "").split("").map(Number);
        correctAnswers = [];

        // Build correct answers based on each digit
        let pos = numberString.includes(".") 
          ? numberString.length - 1 - numberString.indexOf(".") // decimal positions
          : 0;

        let index = numberString.length - 1;
        for (let i = 0; i < numberString.length; i++) {
          if (numberString[i] === ".") continue;
          let exp = index - i;
          if (numberString.includes(".")) {
            exp = numberString.indexOf(".") - i - 1;
          }
          correctAnswers.push(placeValue(digits[i], exp));
        }
      }

      let digitChar = numberString.replace(".", "")[currentDigitIndex];
      document.getElementById('question').innerText =
        `Q${questionCount + 1}: Number is ${numberString}. What is the value of ${digitChar}?`;

      document.getElementById('answer').value = "";
      document.getElementById('feedback').innerText = "";
      document.getElementById('answer').disabled = false;
      document.getElementById('checkBtn').disabled = false;
    }

    function checkAnswer() {
      let userAnswer = document.getElementById('answer').value.trim();
      let feedback = document.getElementById('feedback');

      if (userAnswer == correctAnswers[currentDigitIndex]) {
        feedback.innerText = "✅ Correct!";
        feedback.className = "correct";
        correctCount++;
      } else {
        feedback.innerText = `❌ Wrong. Correct answer is ${correctAnswers[currentDigitIndex]}`;
        feedback.className = "wrong";
      }

      currentDigitIndex++;
      if (currentDigitIndex >= correctAnswers.length) {
        currentDigitIndex = 0;
        questionCount++;
      }

      document.getElementById('score').innerText = `Score: ${correctCount}/${questionCount}`;
      document.getElementById('answer').disabled = true;
      document.getElementById('checkBtn').disabled = true;
    }

    function resetQuiz() {
      questionCount = 0;
      correctCount = 0;
      currentDigitIndex = 0;
      document.getElementById('score').innerText = "";
      document.getElementById('finalScore').innerText = "";
    }
  </script>
</body>
</html>
